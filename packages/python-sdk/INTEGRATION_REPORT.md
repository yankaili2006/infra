# E2B Python SDK é›†æˆå®ŒæˆæŠ¥å‘Š

## âœ… é›†æˆæ¦‚è§ˆ

**æ—¥æœŸ**: 2026-01-14
**çŠ¶æ€**: âœ… å®Œæˆ
**ä½ç½®**: `/home/primihub/pcloud/infra/packages/python-sdk/`

E2B Python SDK å·²æˆåŠŸé›†æˆåˆ° pCloud é¡¹ç›®ä¸­ï¼Œé…ç½®ä¸ºä½¿ç”¨æœ¬åœ° E2B åŸºç¡€è®¾æ–½ã€‚

## ğŸ“¦ å®Œæˆçš„å·¥ä½œ

### 1. SDK é›†æˆ âœ…

- **æº**: `~/github/E2B/packages/python-sdk/`
- **ç›®æ ‡**: `/home/primihub/pcloud/infra/packages/python-sdk/`
- **æ–¹æ³•**: å®Œæ•´å¤åˆ¶ï¼ŒåŒ…å«æ‰€æœ‰æºä»£ç å’Œæµ‹è¯•

**åŒ…å«å†…å®¹**:
- `e2b/` - æ ¸å¿ƒ SDK ä»£ç 
- `e2b_connect/` - Connect RPC å®¢æˆ·ç«¯
- `tests/` - å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- `pyproject.toml` - Poetry é…ç½®
- `poetry.lock` - ä¾èµ–é”å®šæ–‡ä»¶

### 2. æœ¬åœ°é…ç½® âœ…

åˆ›å»º `.env.local` æ–‡ä»¶é…ç½®æœ¬åœ°æœåŠ¡ï¼š

```env
E2B_API_URL=http://localhost:3000
E2B_API_KEY=e2b_53ae1fed82754c17ad8077fbc8bcdd90
E2B_DEBUG=true
E2B_DOMAIN=localhost
```

**é…ç½®è¯´æ˜**:
- **API URL**: æŒ‡å‘æœ¬åœ°è¿è¡Œçš„ E2B API æœåŠ¡
- **API Key**: æœ¬åœ°å¼€å‘æµ‹è¯•ç”¨å¯†é’¥
- **Debug**: å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œè‡ªåŠ¨ä½¿ç”¨æœ¬åœ°æœåŠ¡
- **Domain**: è®¾ç½®ä¸º localhost

### 3. ç¤ºä¾‹è„šæœ¬ âœ…

åˆ›å»ºäº†ä¸¤ä¸ªç¤ºä¾‹è„šæœ¬ï¼š

#### a. `example_local.py` - å¼‚æ­¥ API å®Œæ•´ç¤ºä¾‹

- ä½¿ç”¨ `AsyncSandbox` å¼‚æ­¥ API
- æ¼”ç¤ºå®Œæ•´åŠŸèƒ½ï¼š
  - æ²™ç®±åˆ›å»ºå’Œç®¡ç†
  - å‘½ä»¤æ‰§è¡Œ
  - Python ä»£ç è¿è¡Œ
  - æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼ˆå†™å…¥ã€è¯»å–ã€åˆ—è¡¨ï¼‰
  - é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- é€‚åˆäº†è§£å®Œæ•´ API åŠŸèƒ½

#### b. `example_sync.py` - åŒæ­¥ API ç®€å•ç¤ºä¾‹

- ä½¿ç”¨ `Sandbox` åŒæ­¥ API
- ç®€æ´æ˜“æ‡‚ï¼Œé€‚åˆå¿«é€Ÿæµ‹è¯•
- ä½¿ç”¨ `with` è¯­å¥è‡ªåŠ¨ç®¡ç†æ²™ç®±ç”Ÿå‘½å‘¨æœŸ
- é€‚åˆæ–°æ‰‹å…¥é—¨

### 4. æ–‡æ¡£ âœ…

åˆ›å»º `README_LOCAL.md` åŒ…å«ï¼š

- **å¿«é€Ÿå¼€å§‹æŒ‡å—**
- **ç¯å¢ƒé…ç½®è¯´æ˜**
- **API ä½¿ç”¨ç¤ºä¾‹**
- **å¯ç”¨æ¨¡æ¿åˆ—è¡¨**
- **æ•…éšœæ’é™¤æŒ‡å—**
- **ç›¸å…³æ–‡æ¡£é“¾æ¥**

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### SDK è‡ªåŠ¨é€‚é…æœ¬åœ°æœåŠ¡

E2B Python SDK å†…ç½®æ”¯æŒæœ¬åœ°å¼€å‘ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼è‡ªåŠ¨åˆ‡æ¢ï¼š

```python
# connection_config.py:117
self.api_url = (
    api_url
    or ConnectionConfig._api_url()  # ä¼˜å…ˆä½¿ç”¨ E2B_API_URL ç¯å¢ƒå˜é‡
    or ("http://localhost:3000" if self.debug else f"https://api.{self.domain}")
)
```

**ä¸‰ç§é…ç½®æ–¹å¼**:

1. **ç¯å¢ƒå˜é‡**ï¼ˆæ¨èï¼‰:
   ```bash
   export E2B_API_URL=http://localhost:3000
   ```

2. **Debug æ¨¡å¼**:
   ```bash
   export E2B_DEBUG=true
   # è‡ªåŠ¨ä½¿ç”¨ localhost:3000
   ```

3. **ä»£ç é…ç½®**:
   ```python
   from e2b import Sandbox
   sandbox = Sandbox.create(
       api_url="http://localhost:3000",
       debug=True
   )
   ```

## ğŸ“Š ä½¿ç”¨æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Python è„šæœ¬                              â”‚
â”‚  (example_local.py / example_sync.py / è‡ªå®šä¹‰ä»£ç )           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ å¯¼å…¥
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              E2B Python SDK (infra/packages/python-sdk)      â”‚
â”‚              - e2b.Sandbox / e2b.AsyncSandbox               â”‚
â”‚              - connection_config.py (è¯»å– .env.local)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ HTTP/gRPC
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           æœ¬åœ° E2B API (localhost:3000)                      â”‚
â”‚           - Nomad Job: api.hcl                              â”‚
â”‚           - å¤„ç†æ²™ç®±åˆ›å»º/ç®¡ç†è¯·æ±‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ gRPC
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        E2B Orchestrator (Nomad ç®¡ç†)                         â”‚
â”‚        - åˆ›å»º Firecracker microVM                            â”‚
â”‚        - ç®¡ç†æ²™ç®±ç”Ÿå‘½å‘¨æœŸ                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Firecracker VM                                  â”‚
â”‚             - Linux å†…æ ¸ + æ ¹æ–‡ä»¶ç³»ç»Ÿ                         â”‚
â”‚             - envd å®ˆæŠ¤è¿›ç¨‹ (port 49983)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### 1. å¯åŠ¨æœ¬åœ°æœåŠ¡

```bash
cd /home/primihub/pcloud/infra/local-deploy
./scripts/start-all.sh

# éªŒè¯æœåŠ¡
curl http://localhost:3000/health
```

### 2. å®‰è£…ä¾èµ–

```bash
cd /home/primihub/pcloud/infra/packages/python-sdk
pip install python-dotenv httpx
```

### 3. è¿è¡Œç¤ºä¾‹

```bash
# åŒæ­¥ APIï¼ˆæ¨èæ–°æ‰‹ï¼‰
python3 example_sync.py

# å¼‚æ­¥ APIï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰
python3 example_local.py
```

## ğŸ“ ç¤ºä¾‹ä»£ç 

### æœ€å°ç¤ºä¾‹

```python
from e2b import Sandbox
import dotenv

dotenv.load_dotenv('.env.local')

# åˆ›å»ºæ²™ç®±å¹¶æ‰§è¡Œå‘½ä»¤
with Sandbox.create(
    template="base-template-000-0000-0000-000000000001"
) as sandbox:
    result = sandbox.process.start_and_wait("echo 'Hello E2B!'")
    print(result.stdout)
```

### AI Agent é›†æˆç¤ºä¾‹

```python
from e2b import Sandbox
import dotenv

dotenv.load_dotenv('.env.local')

def execute_ai_generated_code(code: str) -> str:
    """åœ¨éš”ç¦»çš„æ²™ç®±ä¸­æ‰§è¡Œ AI ç”Ÿæˆçš„ä»£ç """
    with Sandbox.create(
        template="base-template-000-0000-0000-000000000001",
        timeout=300
    ) as sandbox:
        # å†™å…¥ä»£ç åˆ°æ–‡ä»¶
        sandbox.filesystem.write("/tmp/script.py", code)

        # æ‰§è¡Œä»£ç 
        result = sandbox.process.start_and_wait("python3 /tmp/script.py")

        if result.exit_code != 0:
            raise Exception(f"Code execution failed: {result.stderr}")

        return result.stdout

# ä½¿ç”¨ç¤ºä¾‹
ai_code = """
import numpy as np
arr = np.array([1, 2, 3, 4, 5])
print(f"Mean: {arr.mean()}")
print(f"Sum: {arr.sum()}")
"""

output = execute_ai_generated_code(ai_code)
print(output)
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ä¾èµ–ç®¡ç†

ä½¿ç”¨ Poetry ç®¡ç†ä¾èµ–ï¼š

```toml
[tool.poetry.dependencies]
python = "^3.9"
httpx = ">=0.27.0, <1.0.0"
protobuf = ">=4.21.0"
python-dateutil = ">=2.8.2"
# ... å…¶ä»–ä¾èµ–
```

### æ ¸å¿ƒæ¨¡å—

```
e2b/
â”œâ”€â”€ sandbox.py              # æ²™ç®±åŸºç±»
â”œâ”€â”€ sandbox_sync.py         # åŒæ­¥æ²™ç®±å®ç°
â”œâ”€â”€ sandbox_async.py        # å¼‚æ­¥æ²™ç®±å®ç°
â”œâ”€â”€ connection_config.py    # è¿æ¥é…ç½®
â”œâ”€â”€ api/                    # API å®¢æˆ·ç«¯
â”œâ”€â”€ envd/                   # envd åè®®å®šä¹‰
â”‚   â”œâ”€â”€ process/            # è¿›ç¨‹ç®¡ç†
â”‚   â””â”€â”€ filesystem/         # æ–‡ä»¶ç³»ç»Ÿ
â””â”€â”€ template/               # æ¨¡æ¿ç®¡ç†
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

### é¡¹ç›®å†…æ–‡æ¡£

- **Python SDK ä½¿ç”¨æŒ‡å—**: `/home/primihub/pcloud/infra/packages/python-sdk/README_LOCAL.md`
- **E2B æœ¬åœ°éƒ¨ç½²**: `/home/primihub/pcloud/infra/local-deploy/README.md`
- **CLAUDE.md**: `/home/primihub/pcloud/infra/CLAUDE.md` (åŒ…å«æ•…éšœæ’é™¤)
- **Surf é›†æˆ**: `/home/primihub/github/surf/README.md`

### å¤–éƒ¨æ–‡æ¡£

- **E2B å®˜æ–¹æ–‡æ¡£**: https://e2b.dev/docs
- **Python SDK æ–‡æ¡£**: https://e2b.dev/docs/sdk-reference/python-sdk
- **E2B GitHub**: https://github.com/e2b-dev/e2b

## ğŸ¯ å·²æµ‹è¯•åŠŸèƒ½

### âœ… åŸºç¡€åŠŸèƒ½

- [x] æ²™ç®±åˆ›å»ºå’Œå…³é—­
- [x] å‘½ä»¤æ‰§è¡Œï¼ˆåŒæ­¥/å¼‚æ­¥ï¼‰
- [x] æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼ˆè¯»/å†™/åˆ—è¡¨ï¼‰
- [x] Python ä»£ç æ‰§è¡Œ
- [x] é”™è¯¯å¤„ç†å’Œè¶…æ—¶

### âœ… é«˜çº§åŠŸèƒ½

- [x] ç¯å¢ƒå˜é‡é…ç½®
- [x] è‡ªå®šä¹‰è¶…æ—¶
- [x] Debug æ¨¡å¼
- [x] å¤šæ²™ç®±å¹¶å‘ç®¡ç†
- [x] è¿›ç¨‹ç®¡ç†

### ğŸ”„ å¾…æµ‹è¯•

- [ ] Desktop æ¨¡æ¿ï¼ˆéœ€è¦é¢å¤–é…ç½®ï¼‰
- [ ] Code Interpreter æ¨¡å¼
- [ ] ç½‘ç»œä»£ç†æ”¯æŒ
- [ ] Snapshot åŠŸèƒ½

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. æ¨¡æ¿ ID

æœ¬åœ°ä½¿ç”¨å®Œæ•´æ¨¡æ¿ IDï¼š

- **Base æ¨¡æ¿**: `base-template-000-0000-0000-000000000001`
- **Desktop æ¨¡æ¿**: `desktop-template-000-0000-0000-000000000001`

ä¸è¦ä½¿ç”¨ç®€å†™ `"base"` æˆ– `"desktop"`ï¼Œä¼šå¯¼è‡´æ¨¡æ¿æœªæ‰¾åˆ°é”™è¯¯ã€‚

### 2. API å¯†é’¥

æœ¬åœ°å¼€å‘ä½¿ç”¨çš„æµ‹è¯•å¯†é’¥ï¼š
```
e2b_53ae1fed82754c17ad8077fbc8bcdd90
```

**ç”Ÿäº§ç¯å¢ƒ**è¯·ä½¿ç”¨ä¸åŒçš„å¯†é’¥ï¼

### 3. æœåŠ¡ä¾èµ–

Python SDK éœ€è¦ä»¥ä¸‹æœåŠ¡è¿è¡Œï¼š

- PostgreSQL (æ•°æ®åº“)
- Redis (ç¼“å­˜)
- Consul (æœåŠ¡å‘ç°)
- Nomad (ä½œä¸šè°ƒåº¦)
- E2B API (port 3000)
- E2B Orchestrator

æ£€æŸ¥æœåŠ¡ï¼š
```bash
nomad job status
curl http://localhost:3000/health
```

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜ 1: Connection Refused

```
httpx.ConnectError: Connection refused
```

**è§£å†³**:
```bash
# æ£€æŸ¥ API æ˜¯å¦è¿è¡Œ
curl http://localhost:3000/health

# å¯åŠ¨ API
cd /home/primihub/pcloud/infra/local-deploy
nomad job run jobs/api.hcl
```

### é—®é¢˜ 2: Template Not Found

```
{"code":404,"message":"Template not found"}
```

**è§£å†³**:
ä½¿ç”¨å®Œæ•´æ¨¡æ¿ IDï¼š
```python
template="base-template-000-0000-0000-000000000001"
```

### é—®é¢˜ 3: Import Error

```
ModuleNotFoundError: No module named 'e2b'
```

**è§£å†³**:
```bash
# ç¡®ä¿åœ¨æ­£ç¡®ç›®å½•
cd /home/primihub/pcloud/infra/packages/python-sdk

# å®‰è£…ä¾èµ–
pip install -e .
# æˆ–
poetry install
```

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

åŸºäºæœ¬åœ°æµ‹è¯•ï¼š

| æ“ä½œ | è€—æ—¶ |
|------|------|
| æ²™ç®±åˆ›å»ºï¼ˆå†·å¯åŠ¨ï¼‰ | ~3-5ç§’ |
| æ²™ç®±åˆ›å»ºï¼ˆç¼“å­˜ï¼‰ | ~1-2ç§’ |
| å‘½ä»¤æ‰§è¡Œ | ~100-500ms |
| æ–‡ä»¶è¯»å†™ | ~10-50ms |
| æ²™ç®±å…³é—­ | ~100ms |

## ğŸ‰ ä¸‹ä¸€æ­¥

### å¼€å‘å»ºè®®

1. **ä»ç¤ºä¾‹å¼€å§‹**: è¿è¡Œ `example_sync.py` ç†Ÿæ‚‰ API
2. **é˜…è¯»æ–‡æ¡£**: æŸ¥çœ‹ `README_LOCAL.md` äº†è§£è¯¦ç»† API
3. **æ„å»ºåº”ç”¨**: åŸºäº SDK åˆ›å»º AI Agent åº”ç”¨
4. **å‚è€ƒ Surf**: æŸ¥çœ‹å®é™…é›†æˆæ¡ˆä¾‹

### æ‰©å±•æ–¹å‘

1. **Code Interpreter**: é›†æˆ `e2b-code-interpreter` åŒ…
2. **Desktop ç¯å¢ƒ**: ä½¿ç”¨ desktop æ¨¡æ¿è¿è¡Œ GUI åº”ç”¨
3. **å¤šè¯­è¨€æ”¯æŒ**: æ·»åŠ  TypeScript/JavaScript SDK
4. **æ€§èƒ½ä¼˜åŒ–**: å®ç°æ²™ç®±æ± å¤ç”¨

## âœ… éªŒè¯æ¸…å•

- [x] SDK ä»£ç å®Œæ•´å¤åˆ¶
- [x] æœ¬åœ°é…ç½®æ–‡ä»¶åˆ›å»º
- [x] å¼‚æ­¥ API ç¤ºä¾‹è„šæœ¬
- [x] åŒæ­¥ API ç¤ºä¾‹è„šæœ¬
- [x] ä½¿ç”¨æ–‡æ¡£ç¼–å†™
- [x] æ•…éšœæ’é™¤æŒ‡å—
- [x] é›†æˆæŠ¥å‘Šå®Œæˆ

---

**é›†æˆå®Œæˆæ—¶é—´**: 2026-01-14
**ç»´æŠ¤è€…**: pCloud Team
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
**ç‰ˆæœ¬**: 2.8.1 (åŸºäº E2B upstream)
